<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game UI</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: black;
    overflow: hidden;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// --------------------
// 状態管理
// --------------------
let screen = "loading"; // loading → menu → game / settings
let time = 0;
let zoom = 0.2;

// --------------------
// 入力
// --------------------
window.addEventListener("keydown", (e) => {
  if (screen === "menu") {
    if (e.key === "Enter") screen = "game";
    if (e.key === "Escape") screen = "settings";
  } else if (screen === "game" || screen === "settings") {
    if (e.key === "Escape") screen = "menu";
  }
});

// --------------------
// メインループ
// --------------------
function loop() {
  time++;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (screen === "loading") drawLoading();
  if (screen === "menu") drawMenu();
  if (screen === "game") drawGame();
  if (screen === "settings") drawSettings();

  requestAnimationFrame(loop);
}
loop();

// --------------------
// 各画面
// --------------------
function drawLoading() {
  ctx.fillStyle = "black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);

  const r = 40;
  ctx.strokeStyle = "white";
  ctx.lineWidth = 6;
  ctx.beginPath();
  ctx.arc(0,0,r, time*0.05, time*0.05 + Math.PI*1.5);
  ctx.stroke();

  ctx.restore();

  ctx.fillStyle = "white";
  ctx.font = "20px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("Loading...", canvas.width/2, canvas.height/2 + 80);

  if (time > 120) {
    screen = "menu";
    time = 0;
  }
}

function drawMenu() {
  // 逆ズーム
  if (zoom < 1) zoom += 0.03;

  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);
  ctx.scale(zoom, zoom);
  ctx.translate(-canvas.width/2, -canvas.height/2);

  ctx.fillStyle = "#111";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "white";
  ctx.textAlign = "center";

  ctx.font = "48px sans-serif";
  ctx.fillText("MENU", canvas.width/2, canvas.height/2 - 80);

  ctx.font = "22px sans-serif";
  ctx.fillText("Enter：ゲーム開始", canvas.width/2, canvas.height/2);
  ctx.fillText("Esc：設定", canvas.width/2, canvas.height/2 + 40);

  ctx.restore();
}

function drawGame() {
  ctx.fillStyle = "#003";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "white";
  ctx.font = "32px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("GAME画面", canvas.width/2, canvas.height/2);

  ctx.font = "18px sans-serif";
  ctx.fillText("Escでメニューに戻る", canvas.width/2, canvas.height/2 + 50);
}

function drawSettings() {
  ctx.fillStyle = "#222";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "white";
  ctx.font = "32px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("設定画面", canvas.width/2, canvas.height/2);

  ctx.font = "18px sans-serif";
  ctx.fillText("Escでメニューに戻る", canvas.width/2, canvas.height/2 + 50);
}
</script>

</body>
</html>
